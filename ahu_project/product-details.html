<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬ - Ø³ÙˆÙ‚ Ø§Ù„Ø­Ø³ÙŠÙ†</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #f4f4f4; margin: 0; padding: 20px; text-align: center; }
        .details-container { max-width: 600px; margin: auto; background: white; padding: 30px; border-radius: 20px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); border-top: 8px solid #006400; }
        #productImg { max-width: 100%; height: 300px; object-fit: contain; border-radius: 10px; background: #fff; margin-bottom: 20px; }
        h1 { color: #006400; margin: 10px 0; }
        .price-tag { font-size: 24px; color: #B8860B; font-weight: bold; margin: 15px 0; }
        .whatsapp-btn { display: inline-block; background: #25D366; color: white; text-decoration: none; padding: 15px 30px; border-radius: 10px; font-weight: bold; font-size: 18px; transition: 0.3s; }
        .whatsapp-btn:hover { background: #1ebe57; transform: scale(1.05); }
        .back-btn { display: block; margin-top: 20px; color: #666; text-decoration: none; font-weight: bold; }
        .rating-box { background: #fff; padding: 15px; border-radius: 10px; margin-top: 20px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        .stars { color: #B8860B; font-size: 25px; cursor: pointer; }
        .stars span:hover, .stars span.active { color: #ffcc00; }
        #reviewsList { text-align: right; margin-top: 15px; }
        .review-item { border-bottom: 1px solid #eee; padding: 10px 0; font-size: 14px; }
    </style>
</head>
<body>

    <div class="details-container">
        <img id="productImg" src="" alt="ØµÙˆØ±Ø© Ø§Ù„Ù…Ù†ØªØ¬">
        <h1 id="productName">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</h1>
        <p class="price-tag" id="productPrice"></p>
        <p style="color: #555; line-height: 1.6;">Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†ØªØ¬ Ù…ØªÙˆÙØ± Ø¶Ù…Ù† Ù…Ø¹Ø±ÙˆØ¶Ø§Øª Ø·Ù„Ø§Ø¨ Ø¬Ø§Ù…Ø¹Ø© Ø§Ù„Ø­Ø³ÙŠÙ† Ø¨Ù† Ø·Ù„Ø§Ù„. ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ø¨Ø§Ø¦Ø¹ Ù…Ø¨Ø§Ø´Ø±Ø© Ø¹Ø¨Ø± Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨ Ù„Ø¥ØªÙ…Ø§Ù… Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø´Ø±Ø§Ø¡.</p>
        <a href="#" id="whatsappBtn" class="whatsapp-btn" target="_blank">ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ø¨Ø§Ø¦Ø¹ ğŸ’¬</a>
        <a href="home.html" class="back-btn">â† Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø³ÙˆÙ‚</a>
    </div>

    <script>
        // Ø§Ù„Ø­Ù„ Ø§Ù„Ø¬Ø°Ø±ÙŠ: Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† localStorage Ø¨Ø¯Ù„ URL
        function getProductDetails() {
            const name = localStorage.getItem('p_name');
            const price = localStorage.getItem('p_price');
            const img = localStorage.getItem('p_img');
            const phone = localStorage.getItem('p_phone');

            if (name) {
                // Ø¹Ø±Ø¶ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Ø§Ù„Ø¹Ù†Ø§ØµØ±
                document.getElementById('productName').innerText = name;
                document.getElementById('productPrice').innerText = price + " Ø¯ÙŠÙ†Ø§Ø±";
                document.getElementById('productImg').src = img;
                
                // ØªØ¬Ù‡ÙŠØ² Ø±Ø§Ø¨Ø· Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨
                const waMessage = encodeURIComponent("Ù…Ø±Ø­Ø¨Ø§Ù‹ØŒ Ø£Ù†Ø§ Ù…Ù‡ØªÙ… Ø¨Ø´Ø±Ø§Ø¡: " + name);
                document.getElementById('whatsappBtn').href = `https://wa.me/${phone}?text=${waMessage}`;
                
                // ØªØºÙŠÙŠØ± Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ØªØ§Ø¨
                document.title = name + " - Ø³ÙˆÙ‚ Ø§Ù„Ø­Ø³ÙŠÙ†";
            } else {
                // Ø¥Ø°Ø§ Ø­Ø§ÙˆÙ„ Ø´Ø®Øµ Ø¯Ø®ÙˆÙ„ Ø§Ù„ØµÙØ­Ø© Ù…Ø¨Ø§Ø´Ø±Ø© Ø¨Ø¯ÙˆÙ† Ø§Ø®ØªÙŠØ§Ø± Ù…Ù†ØªØ¬
                document.getElementById('productName').innerText = "Ø§Ù„Ù…Ù†ØªØ¬ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯";
                setTimeout(() => { window.location.href = "home.html"; }, 2000);
            }
        }

        window.onload = getProductDetails;
    </script>

    <div class="rating-box">
        <h3>â­ ØªÙ‚ÙŠÙŠÙ…Ø§Øª Ø§Ù„Ø·Ù„Ø§Ø¨</h3>
        <div class="stars" id="starRating">
            <span onclick="setRating(1)">â˜†</span><span onclick="setRating(2)">â˜†</span><span onclick="setRating(3)">â˜†</span><span onclick="setRating(4)">â˜†</span><span onclick="setRating(5)">â˜†</span>
        </div>
        <textarea id="reviewText" placeholder="Ø§ÙƒØªØ¨ Ø±Ø£ÙŠÙƒ Ø¨Ø§Ù„Ù…Ù†ØªØ¬..." style="width: 100%; border-radius: 5px; border: 1px solid #ddd; padding: 10px; margin-top: 10px;"></textarea>
        <button onclick="saveReview()" style="background: #006400; color: white; border: none; padding: 8px 15px; border-radius: 5px; margin-top: 10px; cursor: pointer; width: 100%;">Ù†Ø´Ø± Ø§Ù„ØªÙ‚ÙŠÙŠÙ…</button>
        <div id="reviewsList"></div>
    </div>

    <script>
        let currentRating = 0;
        function setRating(n) {
            currentRating = n;
            const stars = document.getElementById('starRating').children;
            for (let i = 0; i < 5; i++) {
                stars[i].innerText = i < n ? "â˜…" : "â˜†";
                stars[i].classList.toggle('active', i < n);
            }
        }

        function saveReview() {
            const text = document.getElementById('reviewText').value;
            const list = document.getElementById('reviewsList');
            if (currentRating === 0 || text === "") {
                alert("ÙŠØ§ Ù‚Ø§Ø¦Ø¯ Ø³ÙŠÙØŒ Ø­Ø· Ù†Ø¬ÙˆÙ… ÙˆØ§ÙƒØªØ¨ Ø±Ø£ÙŠÙƒ Ø£ÙˆÙ„Ø§Ù‹!");
                return;
            }
            const review = `
                <div class="review-item">
                    <div style="color: #B8860B;">${"â˜…".repeat(currentRating)}${"â˜†".repeat(5-currentRating)}</div>
                    <p style="margin: 5px 0;">${text}</p>
                    <small style="color: gray;">Ø¨ÙˆØ§Ø³Ø·Ø©: Ø·Ø§Ù„Ø¨ Ø­Ø³ÙŠÙ†</small>
                </div>
            `;
            list.innerHTML = review + list.innerHTML;
            document.getElementById('reviewText').value = "";
            setRating(0);
        }
    </script>
    







    <div id="chat-icon" onclick="toggleChatBox()" style="position: fixed; top: 20px; right: 20px; width: 60px; height: 60px; background: #075e54; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 30px; cursor: pointer; box-shadow: 0 4px 15px rgba(0,0,0,0.3); z-index: 9999; border: 2px solid white;">
    ğŸ’¬
</div>

<div id="chat-app-container" style="display: none; position: fixed; top: 90px; right: 20px; width: 350px; background: white; border-radius: 15px; overflow: hidden; box-shadow: 0 10px 25px rgba(0,0,0,0.2); z-index: 9998; font-family: 'Segoe UI', sans-serif;">
    <div style="background: #075e54; color: white; padding: 12px; display: flex; justify-content: space-between; align-items: center;">
        <strong>Ù…Ø­Ø§Ø¯Ø«Ø© Ø§Ù„Ø¨Ø§Ø¦Ø¹</strong>
        <select id="userRole" onchange="loadMessages()" style="background: #128c7e; color: white; border: none; padding: 2px; border-radius: 4px; font-size: 11px;">
            <option value="Ø§Ù„Ù…Ø´ØªØ±ÙŠ">Ø§Ù„Ù…Ø´ØªØ±ÙŠ</option>
            <option value="Ø§Ù„Ø¨Ø§Ø¦Ø¹">Ø§Ù„Ø¨Ø§Ø¦Ø¹</option>
        </select>
    </div>

    <div id="chatWindow" style="height: 300px; background: #e5ddd5; padding: 15px; overflow-y: auto; display: flex; flex-direction: column; gap: 10px;"></div>

    <div style="background: #f0f0f0; padding: 10px; display: flex; gap: 5px;">
        <input type="text" id="chatInput" placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„Ø©..." style="flex: 1; border: none; padding: 10px; border-radius: 20px; outline: none;">
        <button onclick="sendChatMessage()" style="background: #075e54; color: white; border: none; width: 35px; height: 35px; border-radius: 50%; cursor: pointer;">â¤</button>
    </div>
</div>
<script>// Ø¯Ø§Ù„Ø© ÙØªØ­ ÙˆØ¥ØºÙ„Ø§Ù‚ Ø§Ù„ØµÙ†Ø¯ÙˆÙ‚ Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ø¯ÙˆÙŠØ±Ø©
function toggleChatBox() {
    const chatBox = document.getElementById('chat-app-container');
    if (chatBox.style.display === "none") {
        chatBox.style.display = "block";
        loadMessages(); // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ ÙÙˆØ± Ø§Ù„ÙØªØ­
    } else {
        chatBox.style.display = "none";
    }
}

// Ù…ÙØªØ§Ø­ Ø§Ù„Ø¯Ø±Ø¯Ø´Ø© (Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬ Ù„Ø¶Ù…Ø§Ù† Ø®ØµÙˆØµÙŠØ© ÙƒÙ„ Ø¥Ø¹Ù„Ø§Ù†)
const chatKey = "chat_" + (localStorage.getItem('p_name') || "generic");

function loadMessages() {
    const chatWindow = document.getElementById('chatWindow');
    const currentUser = document.getElementById('userRole').value;
    const messages = JSON.parse(localStorage.getItem(chatKey)) || [];
    
    chatWindow.innerHTML = "";
    messages.forEach(msg => {
        const isMe = msg.sender === currentUser;
        chatWindow.innerHTML += `
            <div style="align-self: ${isMe ? 'flex-end' : 'flex-start'}; 
                        background: ${isMe ? '#dcf8c6' : '#ffffff'}; 
                        padding: 8px 12px; 
                        border-radius: 10px; 
                        max-width: 80%; 
                        box-shadow: 0 1px 2px rgba(0,0,0,0.1);">
                <small style="display: block; font-size: 9px; color: #075e54; font-weight: bold;">${msg.sender}</small>
                <p style="margin: 0; font-size: 13px;">${msg.text}</p>
                <span style="font-size: 8px; color: #999;">${msg.time}</span>
            </div>
        `;
    });
    chatWindow.scrollTop = chatWindow.scrollHeight;
}

function sendChatMessage() {
    const input = document.getElementById('chatInput');
    const currentUser = document.getElementById('userRole').value;
    if (input.value.trim() === "") return;

    const messages = JSON.parse(localStorage.getItem(chatKey)) || [];
    const now = new Date();
    const time = now.getHours() + ":" + (now.getMinutes() < 10 ? '0' : '') + now.getMinutes();

    messages.push({ text: input.value, sender: currentUser, time: time });
    localStorage.setItem(chatKey, JSON.stringify(messages));
    input.value = "";
    loadMessages();
}</script>
</body>
</html>